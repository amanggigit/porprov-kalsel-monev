<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIM MONEV PORPROV KALSEL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .section-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-left: 4px solid #3b82f6;
        }
        .status-complete { border-left-color: #10b981; }
        .status-warning { border-left-color: #f59e0b; }
        .status-draft { border-left-color: #6b7280; }
        
        .floating-save {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 50;
        }
        
        @keyframes pulse-save {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .saving { animation: pulse-save 1s infinite; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .tab-btn.active {
            border-color: #3b82f6;
            color: #2563eb;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ“Š TIM MONEV PORPROV KALSEL</h1>
            <p class="text-gray-600">Sistem Monitoring & Evaluasi Pertandingan</p>
            <div id="statusContainer" class="mt-4 flex justify-center space-x-4">
                <span id="statusBadge" class="px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-600">â³ Draft</span>
                <span id="autoSaveStatus" class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-600 hidden">ğŸ’¾ Tersimpan</span>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="mb-8">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button id="tabInput" class="tab-btn active whitespace-nowrap py-2 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600">
                        ğŸ“ Input Laporan
                    </button>
                    <button id="tabRekap" class="tab-btn whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ“Š Rekap Data
                    </button>
                    <button id="tabFilter" class="tab-btn whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ” Filter Laporan
                    </button>
                    <button id="tabExport" class="tab-btn whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ“¤ Ekspor Data
                    </button>
                </nav>
            </div>
        </div>

        <!-- Tab Content: Input Laporan -->
        <div id="inputContent" class="tab-content active">

        <form id="monevForm" class="space-y-6">
            <!-- Section A: Data Pertandingan -->
            <div class="section-card rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    ğŸ† A. Data Pertandingan
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“… Tanggal Pertandingan</label>
                        <input type="date" id="tanggal" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">â° Waktu/Jam Pertandingan</label>
                        <input type="time" id="waktu" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸŸï¸ Cabang Olahraga</label>
                        <select id="cabangOlahraga" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="">Pilih Cabang Olahraga</option>
                            <option value="tinju">Tinju</option>
                            <option value="drumband-pdbi">Drumband/PDBI</option>
                            <option value="atletik">Atletik</option>
                            <option value="sepakbola-putra">Sepakbola Putra</option>
                            <option value="sepakbola-putri">Sepakbola Putri</option>
                            <option value="menembak-indoor">Menembak Indoor</option>
                            <option value="menembak-outdoor">Menembak Outdoor</option>
                            <option value="tenis-lapangan">Tenis Lapangan</option>
                            <option value="karate">Karate</option>
                            <option value="pencak-silat">Pencak Silat</option>
                            <option value="kempo">Kempo</option>
                            <option value="jujitsu">Jujitsu</option>
                            <option value="bulu-tangkis">Bulu Tangkis</option>
                            <option value="bola-volly-indoor">Bola Volly Indoor</option>
                            <option value="taekwondo">Taekwondo</option>
                            <option value="tenis-meja">Tenis Meja</option>
                            <option value="bridge">Bridge</option>
                            <option value="iodi">IODI</option>
                            <option value="panjat-tebing">Panjat Tebing</option>
                            <option value="bola-basket">Bola Basket</option>
                            <option value="catur">Catur</option>
                            <option value="e-sport">E-Sport</option>
                            <option value="binaraga">Binaraga</option>
                            <option value="angkat-berat">Angkat Berat</option>
                            <option value="angkat-besi">Angkat Besi</option>
                            <option value="balap-sepeda">Balap Sepeda</option>
                            <option value="sepak-takraw">Sepak Takraw</option>
                            <option value="billiard">Billiard</option>
                            <option value="balap-motor">Balap Motor</option>
                            <option value="skate-board">Skate Board</option>
                            <option value="anggar">Anggar</option>
                            <option value="pickle-ball">Pickle Ball</option>
                            <option value="mma">MMA</option>
                            <option value="petanque">Petanque</option>
                            <option value="senam">Senam</option>
                            <option value="triathlon">Triathlon</option>
                            <option value="panahan">Panahan</option>
                            <option value="futsal">Futsal</option>
                            <option value="bola-tangan">Bola Tangan</option>
                            <option value="dayung">Dayung</option>
                            <option value="berkuda-memanah">Berkuda Memanah</option>
                            <option value="volly-pasir">Volly Pasir</option>
                            <option value="bola-tangan-pasir">Bola Tangan Pasir</option>
                            <option value="gulat">Gulat</option>
                            <option value="sambo">Sambo</option>
                            <option value="golf">Golf</option>
                            <option value="loncat-indah">Loncat Indah</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¯ Kelas/Kategori</label>
                        <input type="text" id="kategori" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: Putra, Putri, Junior, Senior" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ… Nomor Pertandingan</label>
                        <input type="text" id="nomorPertandingan" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: 100m Putra, Ganda Putri, Tim Putra" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Lokasi Venue</label>
                        <select id="lokasi" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="">Pilih Lokasi</option>
                            <option value="gedung-serba-guna-rth-kijang-mas">Gedung Serba Guna RTH Kijang mas</option>
                            <option value="jalan-6-8-kilo-kota-pelaihari">Jalan 6 / 8 Kilo Kota Pelaihari</option>
                            <option value="lap-basket-rth-hasan-baseri">Lap. Basket RTH Hasan Baseri</option>
                            <option value="stadion-pertasi-kencana">Stadion Pertasi Kencana</option>
                            <option value="lapangan-sepakbola-karang-taruna">Lapangan Sepakbola Karang Taruna</option>
                            <option value="lapangan-bola-pinang-berbaris">Lapangan Bola Pinang Berbaris</option>
                            <option value="lap-temnak-indor-bjm">Lap temnak indor bjm</option>
                            <option value="lapangan-pertasi-kencana-outdoor">Lapangan pertasi kencana outdoor</option>
                            <option value="lapangan-tenis-pemuda">Lapangan Tenis Pemuda</option>
                            <option value="gedung-paraduta-kodim-1009-pelaihari">Gedung Paraduta Kodim 1009 Pelaihari</option>
                            <option value="gor-tuntung-pandang">GOR Tuntung Pandang</option>
                            <option value="lapangan-tennis-indoor-pemuda">Lapangan Tennis Indoor Pemuda</option>
                            <option value="gedung-balairung-tuntung-pandang">Gedung Balairung Tuntung Pandang</option>
                            <option value="rth-kijangmas-permai">RTH Kijangmas Permai</option>
                            <option value="lapangan-basket-rth-kijangmas-permai">Lapangan Basket RTH Kijangmas Permai</option>
                            <option value="aula-kecamatan-pelaihari">Aula Kecamatan Pelaihari</option>
                            <option value="aula-dinas-pendidikan-pelaihari">Aula Dinas Pendidikan Pelaihari</option>
                            <option value="aula-hutan-jati-pelaihari">Aula Hutan Jati Pelaihari</option>
                            <option value="jalan-kota-pelaihari">Jalan Kota Pelaihari</option>
                            <option value="jalan-pelaihari-batakan">Jalan Pelaihari - Batakan</option>
                            <option value="sirkuit-sepeda-gunung-kayangan">Sirkuit Sepeda Gunung Kayangan</option>
                            <option value="gedung-aufar-futsal-pelaihari">Gedung Aufar Futsal Pelaihari</option>
                            <option value="gedung-pusdiklat-bilyard-komplek-cip">Gedung Pusdiklat Bilyard Komplek CIP</option>
                            <option value="sirkuit-matah">Sirkuit Matah</option>
                            <option value="rth-hasan-basri-pelaihari">RTH Hasan Basri Pelaihari</option>
                            <option value="gedung-serantang-seruntung-pelaihari">Gedung Serantang Seruntung Pelaihari</option>
                            <option value="sport-center-perdana">Sport Center Perdana</option>
                            <option value="gedung-serba-guna-desa-bumi-jaya">Gedung serba guna Desa Bumi jaya</option>
                            <option value="lapangan-petanque-pertasi-kencana">Lapangan Petanque Pertasi Kencana</option>
                            <option value="basket-indoor-rth-kijang-mas">Basket Indoor RTH Kijang Mas</option>
                            <option value="takisung">Takisung</option>
                            <option value="rth-kijang-mas-permai">RTH Kijang mas Permai</option>
                            <option value="gedung-futsal-bati-bati">Gedung Futsal Bati Bati</option>
                            <option value="bendungan-damit">Bendungan Damit</option>
                            <option value="pantai-batakan-baru">Pantai batakan baru</option>
                            <option value="pantai-takisung">Pantai Takisung</option>
                            <option value="gedung-serba-guna-kecamatan-jorong">Gedung Serba Guna Kecamatan Jorong</option>
                            <option value="stadion-datu-timang-jorong">Stadion Datu Timang Jorong</option>
                            <option value="lapangan-golf-swargaloka-banjarbaru">Lapangan Golf Swargaloka Banjarbaru</option>
                            <option value="kolam-renang-skb-banjarmasin">Kolam Renang SKB Banjarmasin</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section B: Hasil Pertandingan -->
            <div class="section-card rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    ğŸ¥‡ B. Hasil Pertandingan
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘¥ Jumlah Peserta/Tim</label>
                        <input type="number" id="jumlahPeserta" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“Š Jumlah Pertandingan Hari Ini</label>
                        <input type="number" id="jumlahPertandingan" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¥‡ Nama Pemenang/Skor Hasil</label>
                        <textarea id="hasilPertandingan" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: Juara 1: Tim Banjarmasin (Skor: 3-1), Juara 2: Tim Banjarbaru" required></textarea>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“‚ Link Dokumen Hasil (Opsional)</label>
                        <input type="url" id="dokumen" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="https://drive.google.com/file/d/...">
                        <p class="text-xs text-gray-500 mt-1">Masukkan link Google Drive atau link dokumen lainnya</p>
                    </div>
                </div>
            </div>

            <!-- Section C: Monitoring & Evaluasi -->
            <div class="section-card rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    ğŸ“ C. Monitoring & Evaluasi
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Catatan Teknis</label>
                        <textarea id="catatanTeknis" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Alur pertandingan, ketepatan jadwal, kondisi fasilitas venue..." required></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">âš ï¸ Catatan Kendala</label>
                        <textarea id="catatanKendala" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Cuaca, keterlambatan, masalah peralatan, panitia teknis..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">âœ… Rekomendasi/Perbaikan</label>
                        <textarea id="rekomendasi" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Saran perbaikan untuk pertandingan selanjutnya..." required></textarea>
                    </div>
                </div>
            </div>

            <!-- Section D: Petugas Monev -->
            <div class="section-card rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    ğŸ‘¤ D. Identitas Petugas Monev
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘¤ Nama Petugas</label>
                        <select id="namaPetugas" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="">Pilih Nama Petugas</option>
                            <option value="Mahmuddin">Mahmuddin</option>
                            <option value="Wahyudi">Wahyudi</option>
                            <option value="Ahdiansyah">Ahdiansyah</option>
                            <option value="Untung Bagio">Untung Bagio</option>
                            <option value="Muhammad saufi">Muhammad saufi</option>
                            <option value="Karmila nisrina">Karmila nisrina</option>
                            <option value="Ismail">Ismail</option>
                            <option value="Noorhayati">Noorhayati</option>
                            <option value="Shinta Devi">Shinta Devi</option>
                            <option value="Muhammad Noviannor">Muhammad Noviannor</option>
                            <option value="Muhammad Fazri">Muhammad Fazri</option>
                            <option value="Nur Halimah">Nur Halimah</option>
                            <option value="Muhammad Kafi Rizal">Muhammad Kafi Rizal</option>
                            <option value="Siti nor amanda fatimatuzzahra">Siti nor amanda fatimatuzzahra</option>
                            <option value="Galih saputra.S.PD">Galih saputra.S.PD</option>
                            <option value="Arifah">Arifah</option>
                            <option value="Frida Wulandari">Frida Wulandari</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“± Kontak/WhatsApp</label>
                        <input type="tel" id="kontakPetugas" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="08xxxxxxxxxx" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“Œ Unit/Instansi Asal (Opsional)</label>
                        <input type="text" id="unitAsal" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Contoh: Dispora Kalsel, KONI Banjarmasin">
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center pt-6">
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md transition duration-300 transform hover:scale-105">
                    ğŸ“¤ Kirim Laporan Monev
                </button>
            </div>
        </form>
        </div>

        <!-- Tab Content: Rekap Data -->
        <div id="rekapContent" class="tab-content hidden">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-4 shadow-md">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm">Total Laporan</p>
                            <p id="statTotal" class="text-2xl font-bold">0</p>
                        </div>
                        <div class="text-3xl opacity-80">ğŸ“Š</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg p-4 shadow-md">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm">Tanpa Kendala</p>
                            <p id="statBersih" class="text-2xl font-bold">0</p>
                        </div>
                        <div class="text-3xl opacity-80">âœ…</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-lg p-4 shadow-md">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-yellow-100 text-sm">Ada Kendala</p>
                            <p id="statKendala" class="text-2xl font-bold">0</p>
                        </div>
                        <div class="text-3xl opacity-80">âš ï¸</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg p-4 shadow-md">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm">Total Peserta</p>
                            <p id="statPeserta" class="text-2xl font-bold">0</p>
                        </div>
                        <div class="text-3xl opacity-80">ğŸ‘¥</div>
                    </div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                        ğŸ“‹ Data Monitoring
                    </h2>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cabang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kategori</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lokasi</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Peserta</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Petugas</th>
                            </tr>
                        </thead>
                        <tbody id="dataTable" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td colspan="7" class="px-6 py-8 text-center text-gray-500">
                                    ğŸ“ Belum ada data laporan. Silakan input laporan terlebih dahulu.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab Content: Filter Laporan -->
        <div id="filterContent" class="tab-content hidden">
            <div class="bg-white rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    ğŸ” Filter & Pencarian Laporan
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“… Dari Tanggal</label>
                        <input type="date" id="filterTanggalMulai" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“… Sampai Tanggal</label>
                        <input type="date" id="filterTanggalSelesai" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸŸï¸ Cabang Olahraga</label>
                        <select id="filterCabang" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Semua Cabang</option>
                            <option value="tinju">Tinju</option>
                            <option value="drumband-pdbi">Drumband/PDBI</option>
                            <option value="atletik">Atletik</option>
                            <option value="sepakbola-putra">Sepakbola Putra</option>
                            <option value="sepakbola-putri">Sepakbola Putri</option>
                            <option value="menembak-indoor">Menembak Indoor</option>
                            <option value="menembak-outdoor">Menembak Outdoor</option>
                            <option value="tenis-lapangan">Tenis Lapangan</option>
                            <option value="karate">Karate</option>
                            <option value="pencak-silat">Pencak Silat</option>
                            <option value="kempo">Kempo</option>
                            <option value="jujitsu">Jujitsu</option>
                            <option value="bulu-tangkis">Bulu Tangkis</option>
                            <option value="bola-volly-indoor">Bola Volly Indoor</option>
                            <option value="taekwondo">Taekwondo</option>
                            <option value="tenis-meja">Tenis Meja</option>
                            <option value="bridge">Bridge</option>
                            <option value="iodi">IODI</option>
                            <option value="panjat-tebing">Panjat Tebing</option>
                            <option value="bola-basket">Bola Basket</option>
                            <option value="catur">Catur</option>
                            <option value="e-sport">E-Sport</option>
                            <option value="binaraga">Binaraga</option>
                            <option value="angkat-berat">Angkat Berat</option>
                            <option value="angkat-besi">Angkat Besi</option>
                            <option value="balap-sepeda">Balap Sepeda</option>
                            <option value="sepak-takraw">Sepak Takraw</option>
                            <option value="billiard">Billiard</option>
                            <option value="balap-motor">Balap Motor</option>
                            <option value="skate-board">Skate Board</option>
                            <option value="anggar">Anggar</option>
                            <option value="pickle-ball">Pickle Ball</option>
                            <option value="mma">MMA</option>
                            <option value="petanque">Petanque</option>
                            <option value="senam">Senam</option>
                            <option value="triathlon">Triathlon</option>
                            <option value="panahan">Panahan</option>
                            <option value="futsal">Futsal</option>
                            <option value="bola-tangan">Bola Tangan</option>
                            <option value="dayung">Dayung</option>
                            <option value="berkuda-memanah">Berkuda Memanah</option>
                            <option value="volly-pasir">Volly Pasir</option>
                            <option value="bola-tangan-pasir">Bola Tangan Pasir</option>
                            <option value="gulat">Gulat</option>
                            <option value="sambo">Sambo</option>
                            <option value="golf">Golf</option>
                            <option value="loncat-indah">Loncat Indah</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Lokasi Venue</label>
                        <select id="filterLokasi" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Semua Lokasi</option>
                            <option value="gedung-serba-guna-rth-kijang-mas">Gedung Serba Guna RTH Kijang mas</option>
                            <option value="jalan-6-8-kilo-kota-pelaihari">Jalan 6 / 8 Kilo Kota Pelaihari</option>
                            <option value="lap-basket-rth-hasan-baseri">Lap. Basket RTH Hasan Baseri</option>
                            <option value="stadion-pertasi-kencana">Stadion Pertasi Kencana</option>
                            <option value="lapangan-sepakbola-karang-taruna">Lapangan Sepakbola Karang Taruna</option>
                            <option value="lapangan-bola-pinang-berbaris">Lapangan Bola Pinang Berbaris</option>
                            <option value="lap-temnak-indor-bjm">Lap temnak indor bjm</option>
                            <option value="lapangan-pertasi-kencana-outdoor">Lapangan pertasi kencana outdoor</option>
                            <option value="lapangan-tenis-pemuda">Lapangan Tenis Pemuda</option>
                            <option value="gedung-paraduta-kodim-1009-pelaihari">Gedung Paraduta Kodim 1009 Pelaihari</option>
                            <option value="gor-tuntung-pandang">GOR Tuntung Pandang</option>
                            <option value="lapangan-tennis-indoor-pemuda">Lapangan Tennis Indoor Pemuda</option>
                            <option value="gedung-balairung-tuntung-pandang">Gedung Balairung Tuntung Pandang</option>
                            <option value="rth-kijangmas-permai">RTH Kijangmas Permai</option>
                            <option value="lapangan-basket-rth-kijangmas-permai">Lapangan Basket RTH Kijangmas Permai</option>
                            <option value="aula-kecamatan-pelaihari">Aula Kecamatan Pelaihari</option>
                            <option value="aula-dinas-pendidikan-pelaihari">Aula Dinas Pendidikan Pelaihari</option>
                            <option value="aula-hutan-jati-pelaihari">Aula Hutan Jati Pelaihari</option>
                            <option value="jalan-kota-pelaihari">Jalan Kota Pelaihari</option>
                            <option value="jalan-pelaihari-batakan">Jalan Pelaihari - Batakan</option>
                            <option value="sirkuit-sepeda-gunung-kayangan">Sirkuit Sepeda Gunung Kayangan</option>
                            <option value="gedung-aufar-futsal-pelaihari">Gedung Aufar Futsal Pelaihari</option>
                            <option value="gedung-pusdiklat-bilyard-komplek-cip">Gedung Pusdiklat Bilyard Komplek CIP</option>
                            <option value="sirkuit-matah">Sirkuit Matah</option>
                            <option value="rth-hasan-basri-pelaihari">RTH Hasan Basri Pelaihari</option>
                            <option value="gedung-serantang-seruntung-pelaihari">Gedung Serantang Seruntung Pelaihari</option>
                            <option value="sport-center-perdana">Sport Center Perdana</option>
                            <option value="gedung-serba-guna-desa-bumi-jaya">Gedung serba guna Desa Bumi jaya</option>
                            <option value="lapangan-petanque-pertasi-kencana">Lapangan Petanque Pertasi Kencana</option>
                            <option value="basket-indoor-rth-kijang-mas">Basket Indoor RTH Kijang Mas</option>
                            <option value="takisung">Takisung</option>
                            <option value="rth-kijang-mas-permai">RTH Kijang mas Permai</option>
                            <option value="gedung-futsal-bati-bati">Gedung Futsal Bati Bati</option>
                            <option value="bendungan-damit">Bendungan Damit</option>
                            <option value="pantai-batakan-baru">Pantai batakan baru</option>
                            <option value="pantai-takisung">Pantai Takisung</option>
                            <option value="gedung-serba-guna-kecamatan-jorong">Gedung Serba Guna Kecamatan Jorong</option>
                            <option value="stadion-datu-timang-jorong">Stadion Datu Timang Jorong</option>
                            <option value="lapangan-golf-swargaloka-banjarbaru">Lapangan Golf Swargaloka Banjarbaru</option>
                            <option value="kolam-renang-skb-banjarmasin">Kolam Renang SKB Banjarmasin</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘¤ Nama Petugas</label>
                        <input type="text" id="filterPetugas" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Cari nama petugas...">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">âš ï¸ Status Kendala</label>
                        <select id="filterStatus" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Semua Status</option>
                            <option value="lancar">Tanpa Kendala</option>
                            <option value="kendala">Ada Kendala</option>
                        </select>
                    </div>
                </div>

                <div class="flex flex-wrap gap-3">
                    <button id="btnFilter" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition duration-200 flex items-center">
                        ğŸ” Terapkan Filter
                    </button>
                    <button id="btnReset" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-md transition duration-200 flex items-center">
                        ğŸ”„ Reset Filter
                    </button>
                    <button id="btnViewResults" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-md transition duration-200 flex items-center">
                        ğŸ“Š Lihat Hasil
                    </button>
                </div>

                <!-- Filter Results Preview -->
                <div id="filterResults" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
                    <h3 class="text-lg font-medium text-gray-800 mb-2">ğŸ“‹ Hasil Filter</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div class="bg-white p-3 rounded">
                            <div class="text-2xl font-bold text-blue-600" id="previewTotal">0</div>
                            <div class="text-sm text-gray-600">Total Laporan</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-2xl font-bold text-green-600" id="previewBersih">0</div>
                            <div class="text-sm text-gray-600">Tanpa Kendala</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-2xl font-bold text-yellow-600" id="previewKendala">0</div>
                            <div class="text-sm text-gray-600">Ada Kendala</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-2xl font-bold text-purple-600" id="previewPeserta">0</div>
                            <div class="text-sm text-gray-600">Total Peserta</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Ekspor Data -->
        <div id="exportContent" class="tab-content hidden">
            <div class="bg-white rounded-lg p-6 shadow-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    ğŸ“¤ Ekspor & Unduh Data
                </h2>
                
                <!-- Export Options -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <div class="text-2xl mr-3">ğŸ“„</div>
                            <div>
                                <h3 class="text-lg font-medium text-gray-800">Ekspor PDF</h3>
                                <p class="text-sm text-gray-600">Format laporan siap cetak</p>
                            </div>
                        </div>
                        <button id="btnExportPDF" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center justify-center">
                            ğŸ“„ Unduh PDF
                        </button>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <div class="text-2xl mr-3">ğŸ“‹</div>
                            <div>
                                <h3 class="text-lg font-medium text-gray-800">Ekspor JSON</h3>
                                <p class="text-sm text-gray-600">Data mentah untuk integrasi</p>
                            </div>
                        </div>
                        <button id="btnExportJSON" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition duration-200 flex items-center justify-center">
                            ğŸ“‹ Unduh JSON
                        </button>
                    </div>
                </div>

                <!-- Export Statistics -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-3">ğŸ“Š Statistik Data yang Akan Diekspor</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div class="bg-white p-3 rounded">
                            <div class="text-xl font-bold text-blue-600" id="exportStatTotal">0</div>
                            <div class="text-sm text-gray-600">Total Laporan</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-xl font-bold text-green-600" id="exportStatBersih">0</div>
                            <div class="text-sm text-gray-600">Tanpa Kendala</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-xl font-bold text-yellow-600" id="exportStatKendala">0</div>
                            <div class="text-sm text-gray-600">Ada Kendala</div>
                        </div>
                        <div class="bg-white p-3 rounded">
                            <div class="text-xl font-bold text-purple-600" id="exportStatPeserta">0</div>
                            <div class="text-sm text-gray-600">Total Peserta</div>
                        </div>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="text-lg font-medium text-gray-800 mb-3">âš™ï¸ Opsi Ekspor</h3>
                    <div class="space-y-3">
                        <label class="flex items-center">
                            <input type="checkbox" id="exportFiltered" class="mr-2" checked>
                            <span class="text-sm text-gray-700">Ekspor hanya data yang sudah difilter</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="exportWithTimestamp" class="mr-2" checked>
                            <span class="text-sm text-gray-700">Sertakan timestamp ekspor</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="exportWithStats" class="mr-2" checked>
                            <span class="text-sm text-gray-700">Sertakan ringkasan statistik</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Auto-save Indicator -->
        <div id="floatingSave" class="floating-save hidden">
            <div class="bg-green-500 text-white px-4 py-2 rounded-full shadow-lg">
                ğŸ’¾ Tersimpan otomatis
            </div>
        </div>
    </div>

    <script>
        // KONFIGURASI GOOGLE SHEETS
        // GANTI URL INI DENGAN URL APPS SCRIPT ANDA
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby_lt65vKR_JNJbVVBkMz74YE2ILV0x1TlHoxRid68omnrZVTYo2FpQJO2UC5vzsIvkFQ/exec';
        
        // Data lokal (akan dimuat dari Google Sheets)
        let allReports = [];
        let filteredReports = [];
        let isOnline = navigator.onLine;

        // Data petugas untuk auto-fill kontak
        const petugasData = {
            'Mahmuddin': '081352569399',
            'Wahyudi': '082354877771',
            'Ahdiansyah': '081351201123',
            'Untung Bagio': '083141401925',
            'Muhammad saufi': '087837053724',
            'Karmila nisrina': '081515769979',
            'Ismail': '082152226733',
            'Noorhayati': '081381999988',
            'Shinta Devi': '085348821380',
            'Muhammad Noviannor': '082253531373',
            'Muhammad Fazri': '081257336823',
            'Nur Halimah': '082139001667',
            'Muhammad Kafi Rizal': '082151706475',
            'Siti nor amanda fatimatuzzahra': '085389038549',
            'Galih saputra.S.PD': '081258052133',
            'Arifah': '082544333924',
            'Frida Wulandari': '081349936700'
        };

        // FUNGSI GOOGLE SHEETS
        
        // Kirim data ke Google Sheets
        async function sendToGoogleSheets(data) {
            try {
                showNotification('ğŸ“¤ Mengirim ke Google Sheets...');
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addReport',
                        data: data
                    })
                });
                
                // Karena mode no-cors, kita tidak bisa membaca response
                // Tapi kita asumsikan berhasil jika tidak ada error
                showNotification('âœ… Data berhasil disimpan ke Google Sheets!');
                return true;
            } catch (error) {
                console.error('Error sending to Google Sheets:', error);
                showNotification('âŒ Gagal mengirim ke Google Sheets. Data disimpan lokal.');
                return false;
            }
        }
        
        // Ambil data dari Google Sheets
        async function loadFromGoogleSheets() {
            try {
                showNotification('ğŸ“¥ Memuat data dari Google Sheets...');
                
                const response = await fetch(GOOGLE_SCRIPT_URL + '?action=getReports');
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.reports) {
                        allReports = data.reports;
                        filteredReports = [...allReports];
                        
                        // Simpan juga ke localStorage sebagai backup
                        localStorage.setItem('allReports', JSON.stringify(allReports));
                        localStorage.setItem('lastSync', new Date().toISOString());
                        
                        showNotification('âœ… Data berhasil dimuat dari Google Sheets!');
                        return true;
                    }
                }
                throw new Error('Invalid response');
            } catch (error) {
                console.error('Error loading from Google Sheets:', error);
                showNotification('âš ï¸ Menggunakan data lokal. Periksa koneksi internet.');
                loadReportsFromStorage(); // Fallback ke localStorage
                return false;
            }
        }
        
        // Sinkronisasi otomatis
        async function autoSync() {
            if (!isOnline) return;
            
            const lastSync = localStorage.getItem('lastSync');
            const now = new Date();
            const lastSyncTime = lastSync ? new Date(lastSync) : new Date(0);
            
            // Sinkronisasi setiap 5 menit
            if (now - lastSyncTime > 5 * 60 * 1000) {
                await loadFromGoogleSheets();
            }
        }
        
        // Monitor status koneksi
        window.addEventListener('online', () => {
            isOnline = true;
            showNotification('ğŸŒ Koneksi internet tersambung');
            autoSync();
        });
        
        window.addEventListener('offline', () => {
            isOnline = false;
            showNotification('ğŸ“± Mode offline - data disimpan lokal');
        });

        // Auto-save functionality
        let autoSaveTimeout;
        const formData = {};

        function autoSave() {
            const form = document.getElementById('monevForm');
            const formDataObj = new FormData(form);
            
            // Simpan ke localStorage
            for (let [key, value] of formDataObj.entries()) {
                formData[key] = value;
            }
            localStorage.setItem('monevData', JSON.stringify(formData));
            
            // Show save indicator
            const saveStatus = document.getElementById('autoSaveStatus');
            const floatingSave = document.getElementById('floatingSave');
            
            saveStatus.classList.remove('hidden');
            floatingSave.classList.remove('hidden');
            floatingSave.classList.add('saving');
            
            setTimeout(() => {
                saveStatus.classList.add('hidden');
                floatingSave.classList.add('hidden');
                floatingSave.classList.remove('saving');
            }, 2000);
            
            updateStatus();
        }

        // Load saved data
        function loadSavedData() {
            const saved = localStorage.getItem('monevData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = data[key];
                    }
                });
            }
        }

        // Update status badge
        function updateStatus() {
            const form = document.getElementById('monevForm');
            const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            const kendala = document.getElementById('catatanKendala').value.trim();
            
            let filledCount = 0;
            inputs.forEach(input => {
                if (input.value.trim()) filledCount++;
            });
            
            const statusBadge = document.getElementById('statusBadge');
            const sections = document.querySelectorAll('.section-card');
            
            if (filledCount === inputs.length) {
                if (kendala) {
                    statusBadge.textContent = 'âš ï¸ Ada Kendala';
                    statusBadge.className = 'px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-600';
                    sections.forEach(section => {
                        section.classList.remove('status-complete', 'status-draft');
                        section.classList.add('status-warning');
                    });
                } else {
                    statusBadge.textContent = 'âœ”ï¸ Lengkap';
                    statusBadge.className = 'px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-600';
                    sections.forEach(section => {
                        section.classList.remove('status-warning', 'status-draft');
                        section.classList.add('status-complete');
                    });
                }
            } else {
                statusBadge.textContent = 'â³ Draft';
                statusBadge.className = 'px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-600';
                sections.forEach(section => {
                    section.classList.remove('status-complete', 'status-warning');
                    section.classList.add('status-draft');
                });
            }
        }

        // Auto-fill kontak berdasarkan nama petugas
        document.getElementById('namaPetugas').addEventListener('change', function() {
            const nama = this.value;
            const kontakField = document.getElementById('kontakPetugas');
            
            // Cari kontak yang cocok
            const kontak = petugasData[nama];
            if (kontak) {
                kontakField.value = kontak;
                // Show notification
                showNotification('ğŸ“± Kontak otomatis terisi!');
            } else {
                kontakField.value = '';
            }
            
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(autoSave, 1000);
        });

        // Function to show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 2000);
        }

        // Auto-save on input change
        document.getElementById('monevForm').addEventListener('input', function() {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(autoSave, 1000);
        });

        // Form submission
        document.getElementById('monevForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            submitBtn.textContent = 'ğŸ“¤ Mengirim...';
            submitBtn.disabled = true;
            
            try {
                // Collect form data
                const formData = new FormData(this);
                const reportData = {};
                for (let [key, value] of formData.entries()) {
                    reportData[key] = value;
                }
                
                // Tambahkan timestamp dan ID
                reportData.id = Date.now();
                reportData.timestamp = new Date().toISOString();
                
                // Coba kirim ke Google Sheets dulu
                let success = false;
                if (isOnline) {
                    success = await sendToGoogleSheets(reportData);
                }
                
                // Simpan lokal sebagai backup
                addNewReport(reportData);
                
                if (success) {
                    alert('âœ… Laporan Monev berhasil dikirim ke Google Sheets!\n\nTerima kasih atas kontribusi Anda dalam monitoring PORPROV KALSEL.');
                } else {
                    alert('âš ï¸ Laporan disimpan lokal. Akan otomatis tersinkron saat online.\n\nTerima kasih atas kontribusi Anda dalam monitoring PORPROV KALSEL.');
                }
                
                // Clear form and localStorage
                this.reset();
                localStorage.removeItem('monevData');
                updateStatus();
                
                // Refresh data display
                if (document.getElementById('rekapContent').classList.contains('active')) {
                    loadRekapData();
                }
                
            } catch (error) {
                console.error('Error submitting form:', error);
                alert('âŒ Terjadi kesalahan. Silakan coba lagi.');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        // Tab functionality
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('border-transparent', 'text-gray-500');
                btn.classList.remove('border-blue-500', 'text-blue-600');
            });
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'input') {
                const btn = document.getElementById('tabInput');
                btn.classList.add('active', 'border-blue-500', 'text-blue-600');
                btn.classList.remove('border-transparent', 'text-gray-500');
                document.getElementById('inputContent').classList.add('active');
                document.getElementById('statusContainer').style.display = 'flex';
            } else if (tabName === 'rekap') {
                const btn = document.getElementById('tabRekap');
                btn.classList.add('active', 'border-blue-500', 'text-blue-600');
                btn.classList.remove('border-transparent', 'text-gray-500');
                document.getElementById('rekapContent').classList.add('active');
                document.getElementById('statusContainer').style.display = 'none';
                loadRekapData();
            } else if (tabName === 'filter') {
                const btn = document.getElementById('tabFilter');
                btn.classList.add('active', 'border-blue-500', 'text-blue-600');
                btn.classList.remove('border-transparent', 'text-gray-500');
                document.getElementById('filterContent').classList.add('active');
                document.getElementById('statusContainer').style.display = 'none';
                updateFilterPreview();
            } else if (tabName === 'export') {
                const btn = document.getElementById('tabExport');
                btn.classList.add('active', 'border-blue-500', 'text-blue-600');
                btn.classList.remove('border-transparent', 'text-gray-500');
                document.getElementById('exportContent').classList.add('active');
                document.getElementById('statusContainer').style.display = 'none';
                updateExportStats();
            }
        }

        // Load and display rekap data
        function loadRekapData() {
            updateStatistics();
            displayReports(filteredReports);
        }

        // Update statistics
        function updateStatistics() {
            const total = filteredReports.length;
            const bersih = filteredReports.filter(r => !r.catatanKendala || r.catatanKendala.trim() === '').length;
            const kendala = total - bersih;
            const totalPeserta = filteredReports.reduce((sum, r) => sum + parseInt(r.jumlahPeserta || 0), 0);

            document.getElementById('statTotal').textContent = total;
            document.getElementById('statBersih').textContent = bersih;
            document.getElementById('statKendala').textContent = kendala;
            document.getElementById('statPeserta').textContent = totalPeserta;
        }

        // Display reports in table
        function displayReports(reports) {
            const tableBody = document.getElementById('dataTable');
            
            if (reports.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-8 text-center text-gray-500">
                            ğŸ“ Tidak ada data yang sesuai dengan filter.
                        </td>
                    </tr>
                `;
                return;
            }

            const locationNames = {
                'gedung-serba-guna-rth-kijang-mas': 'Gedung Serba Guna RTH Kijang mas',
                'jalan-6-8-kilo-kota-pelaihari': 'Jalan 6 / 8 Kilo Kota Pelaihari',
                'lap-basket-rth-hasan-baseri': 'Lap. Basket RTH Hasan Baseri',
                'stadion-pertasi-kencana': 'Stadion Pertasi Kencana',
                'lapangan-sepakbola-karang-taruna': 'Lapangan Sepakbola Karang Taruna',
                'lapangan-bola-pinang-berbaris': 'Lapangan Bola Pinang Berbaris',
                'lap-temnak-indor-bjm': 'Lap temnak indor bjm',
                'lapangan-pertasi-kencana-outdoor': 'Lapangan pertasi kencana outdoor',
                'lapangan-tenis-pemuda': 'Lapangan Tenis Pemuda',
                'gedung-paraduta-kodim-1009-pelaihari': 'Gedung Paraduta Kodim 1009 Pelaihari',
                'gor-tuntung-pandang': 'GOR Tuntung Pandang',
                'lapangan-tennis-indoor-pemuda': 'Lapangan Tennis Indoor Pemuda',
                'gedung-balairung-tuntung-pandang': 'Gedung Balairung Tuntung Pandang',
                'rth-kijangmas-permai': 'RTH Kijangmas Permai',
                'lapangan-basket-rth-kijangmas-permai': 'Lapangan Basket RTH Kijangmas Permai',
                'aula-kecamatan-pelaihari': 'Aula Kecamatan Pelaihari',
                'aula-dinas-pendidikan-pelaihari': 'Aula Dinas Pendidikan Pelaihari',
                'aula-hutan-jati-pelaihari': 'Aula Hutan Jati Pelaihari',
                'jalan-kota-pelaihari': 'Jalan Kota Pelaihari',
                'jalan-pelaihari-batakan': 'Jalan Pelaihari - Batakan',
                'sirkuit-sepeda-gunung-kayangan': 'Sirkuit Sepeda Gunung Kayangan',
                'gedung-aufar-futsal-pelaihari': 'Gedung Aufar Futsal Pelaihari',
                'gedung-pusdiklat-bilyard-komplek-cip': 'Gedung Pusdiklat Bilyard Komplek CIP',
                'sirkuit-matah': 'Sirkuit Matah',
                'rth-hasan-basri-pelaihari': 'RTH Hasan Basri Pelaihari',
                'gedung-serantang-seruntung-pelaihari': 'Gedung Serantang Seruntung Pelaihari',
                'sport-center-perdana': 'Sport Center Perdana',
                'gedung-serba-guna-desa-bumi-jaya': 'Gedung serba guna Desa Bumi jaya',
                'lapangan-petanque-pertasi-kencana': 'Lapangan Petanque Pertasi Kencana',
                'basket-indoor-rth-kijang-mas': 'Basket Indoor RTH Kijang Mas',
                'takisung': 'Takisung',
                'rth-kijang-mas-permai': 'RTH Kijang mas Permai',
                'gedung-futsal-bati-bati': 'Gedung Futsal Bati Bati',
                'bendungan-damit': 'Bendungan Damit',
                'pantai-batakan-baru': 'Pantai batakan baru',
                'pantai-takisung': 'Pantai Takisung',
                'gedung-serba-guna-kecamatan-jorong': 'Gedung Serba Guna Kecamatan Jorong',
                'stadion-datu-timang-jorong': 'Stadion Datu Timang Jorong',
                'lapangan-golf-swargaloka-banjarbaru': 'Lapangan Golf Swargaloka Banjarbaru',
                'kolam-renang-skb-banjarmasin': 'Kolam Renang SKB Banjarmasin'
            };

            const cabangNames = {
                'tinju': 'Tinju',
                'drumband-pdbi': 'Drumband/PDBI',
                'atletik': 'Atletik',
                'sepakbola-putra': 'Sepakbola Putra',
                'sepakbola-putri': 'Sepakbola Putri',
                'menembak-indoor': 'Menembak Indoor',
                'menembak-outdoor': 'Menembak Outdoor',
                'tenis-lapangan': 'Tenis Lapangan',
                'karate': 'Karate',
                'pencak-silat': 'Pencak Silat',
                'kempo': 'Kempo',
                'jujitsu': 'Jujitsu',
                'bulu-tangkis': 'Bulu Tangkis',
                'bola-volly-indoor': 'Bola Volly Indoor',
                'taekwondo': 'Taekwondo',
                'tenis-meja': 'Tenis Meja',
                'bridge': 'Bridge',
                'iodi': 'IODI',
                'panjat-tebing': 'Panjat Tebing',
                'bola-basket': 'Bola Basket',
                'catur': 'Catur',
                'e-sport': 'E-Sport',
                'binaraga': 'Binaraga',
                'angkat-berat': 'Angkat Berat',
                'angkat-besi': 'Angkat Besi',
                'balap-sepeda': 'Balap Sepeda',
                'sepak-takraw': 'Sepak Takraw',
                'billiard': 'Billiard',
                'balap-motor': 'Balap Motor',
                'skate-board': 'Skate Board',
                'anggar': 'Anggar',
                'pickle-ball': 'Pickle Ball',
                'mma': 'MMA',
                'petanque': 'Petanque',
                'senam': 'Senam',
                'triathlon': 'Triathlon',
                'panahan': 'Panahan',
                'futsal': 'Futsal',
                'bola-tangan': 'Bola Tangan',
                'dayung': 'Dayung',
                'berkuda-memanah': 'Berkuda Memanah',
                'volly-pasir': 'Volly Pasir',
                'bola-tangan-pasir': 'Bola Tangan Pasir',
                'gulat': 'Gulat',
                'sambo': 'Sambo',
                'golf': 'Golf',
                'loncat-indah': 'Loncat Indah'
            };

            tableBody.innerHTML = reports.map(report => {
                const hasKendala = report.catatanKendala && report.catatanKendala.trim() !== '';
                const statusBadge = hasKendala 
                    ? '<span class="px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full">âš ï¸ Ada Kendala</span>'
                    : '<span class="px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full">âœ… Lancar</span>';

                return `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${new Date(report.tanggal).toLocaleDateString('id-ID')}
                            <br><span class="text-xs text-gray-500">${report.waktu}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${cabangNames[report.cabangOlahraga] || report.cabangOlahraga}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${report.kategori}
                            <br><span class="text-xs text-gray-500">${report.nomorPertandingan}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${locationNames[report.lokasi] || report.lokasi}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${report.jumlahPeserta} orang
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            ${statusBadge}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${report.namaPetugas}
                            <br><span class="text-xs text-gray-500">${report.unitAsal || '-'}</span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Filter functionality
        function applyFilters() {
            const startDate = document.getElementById('filterTanggalMulai').value;
            const endDate = document.getElementById('filterTanggalSelesai').value;
            const cabang = document.getElementById('filterCabang').value;
            const lokasi = document.getElementById('filterLokasi').value;
            const petugas = document.getElementById('filterPetugas').value.toLowerCase();
            const status = document.getElementById('filterStatus').value;

            filteredReports = allReports.filter(report => {
                let matches = true;

                if (startDate && report.tanggal < startDate) matches = false;
                if (endDate && report.tanggal > endDate) matches = false;
                if (cabang && report.cabangOlahraga !== cabang) matches = false;
                if (lokasi && report.lokasi !== lokasi) matches = false;
                if (petugas && !report.namaPetugas.toLowerCase().includes(petugas)) matches = false;
                
                if (status) {
                    const hasKendala = report.catatanKendala && report.catatanKendala.trim() !== '';
                    if (status === 'lancar' && hasKendala) matches = false;
                    if (status === 'kendala' && !hasKendala) matches = false;
                }

                return matches;
            });

            updateStatistics();
            displayReports(filteredReports);
            updateFilterPreview();
        }

        // Update filter preview
        function updateFilterPreview() {
            const total = filteredReports.length;
            const bersih = filteredReports.filter(r => !r.catatanKendala || r.catatanKendala.trim() === '').length;
            const kendala = total - bersih;
            const totalPeserta = filteredReports.reduce((sum, r) => sum + parseInt(r.jumlahPeserta || 0), 0);

            document.getElementById('previewTotal').textContent = total;
            document.getElementById('previewBersih').textContent = bersih;
            document.getElementById('previewKendala').textContent = kendala;
            document.getElementById('previewPeserta').textContent = totalPeserta;
        }

        // Update export statistics
        function updateExportStats() {
            const total = filteredReports.length;
            const bersih = filteredReports.filter(r => !r.catatanKendala || r.catatanKendala.trim() === '').length;
            const kendala = total - bersih;
            const totalPeserta = filteredReports.reduce((sum, r) => sum + parseInt(r.jumlahPeserta || 0), 0);

            document.getElementById('exportStatTotal').textContent = total;
            document.getElementById('exportStatBersih').textContent = bersih;
            document.getElementById('exportStatKendala').textContent = kendala;
            document.getElementById('exportStatPeserta').textContent = totalPeserta;
        }

        // Reset filters
        function resetFilters() {
            document.getElementById('filterTanggalMulai').value = '';
            document.getElementById('filterTanggalSelesai').value = '';
            document.getElementById('filterCabang').value = '';
            document.getElementById('filterLokasi').value = '';
            
            filteredReports = [...allReports];
            updateStatistics();
            displayReports(filteredReports);
        }

        // Export to PDF
        function exportToPDF() {
            const reportData = filteredReports.map(report => {
                return `
LAPORAN MONITORING PORPROV KALSEL
=================================

Tanggal: ${new Date(report.tanggal).toLocaleDateString('id-ID')} ${report.waktu}
Cabang Olahraga: ${report.cabangOlahraga}
Kategori: ${report.kategori}
Nomor Pertandingan: ${report.nomorPertandingan}
Lokasi: ${report.lokasi}
Jumlah Peserta: ${report.jumlahPeserta}

HASIL PERTANDINGAN:
${report.hasilPertandingan}

CATATAN TEKNIS:
${report.catatanTeknis}

CATATAN KENDALA:
${report.catatanKendala || 'Tidak ada kendala'}

REKOMENDASI:
${report.rekomendasi}

PETUGAS MONEV:
Nama: ${report.namaPetugas}
Kontak: ${report.kontakPetugas}
Unit: ${report.unitAsal || '-'}

-----------------------------------
                `;
            }).join('\n');

            const blob = new Blob([reportData], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Laporan_Monev_PORPROV_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('ğŸ“„ File PDF berhasil diunduh!');
        }

        // Export to JSON
        function exportToJSON() {
            const dataToExport = {
                exported_at: new Date().toISOString(),
                total_reports: filteredReports.length,
                reports: filteredReports
            };

            const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Data_Monev_PORPROV_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('ğŸ“‹ File JSON berhasil diunduh!');
        }

        // Add new report to data
        function addNewReport(formData) {
            const newReport = {
                id: allReports.length + 1,
                ...formData,
                timestamp: new Date().toISOString()
            };
            
            allReports.push(newReport);
            filteredReports = [...allReports];
            
            // Save to localStorage
            localStorage.setItem('allReports', JSON.stringify(allReports));
        }

        // Load reports from localStorage
        function loadReportsFromStorage() {
            const saved = localStorage.getItem('allReports');
            if (saved) {
                allReports = JSON.parse(saved);
                filteredReports = [...allReports];
            }
        }

        // Event listeners
        document.getElementById('tabInput').addEventListener('click', () => switchTab('input'));
        document.getElementById('tabRekap').addEventListener('click', () => switchTab('rekap'));
        document.getElementById('tabFilter').addEventListener('click', () => switchTab('filter'));
        document.getElementById('tabExport').addEventListener('click', () => switchTab('export'));
        document.getElementById('btnFilter').addEventListener('click', applyFilters);
        document.getElementById('btnReset').addEventListener('click', resetFilters);
        document.getElementById('btnViewResults').addEventListener('click', () => {
            applyFilters();
            document.getElementById('filterResults').classList.remove('hidden');
            showNotification('ğŸ” Filter berhasil diterapkan!');
        });
        document.getElementById('btnExportPDF').addEventListener('click', exportToPDF);
        document.getElementById('btnExportJSON').addEventListener('click', exportToJSON);

        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tanggal').value = today;
            
            // Load saved form data
            loadSavedData();
            updateStatus();
            
            // Load data dari Google Sheets atau localStorage
            if (isOnline) {
                await loadFromGoogleSheets();
            } else {
                loadReportsFromStorage();
            }
            
            // Setup auto-sync interval
            setInterval(autoSync, 5 * 60 * 1000); // Setiap 5 menit
            
            // Show connection status
            const statusIndicator = document.createElement('div');
            statusIndicator.id = 'connectionStatus';
            statusIndicator.className = 'fixed top-4 left-4 px-3 py-1 rounded-full text-sm font-medium z-50';
            statusIndicator.textContent = isOnline ? 'ğŸŒ Online' : 'ğŸ“± Offline';
            statusIndicator.style.backgroundColor = isOnline ? '#10b981' : '#f59e0b';
            statusIndicator.style.color = 'white';
            document.body.appendChild(statusIndicator);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987b23e062edfd1c',t:'MTc1OTMxMzExMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

